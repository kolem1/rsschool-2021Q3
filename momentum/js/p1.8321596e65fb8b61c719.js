(()=>{"use strict";function t(t,e){localStorage.setItem(e,t.value)}function e(t,e){const i=localStorage.getItem(e);i&&(t.value=i)}function i(t){let e=Math.round(t);return(e-(e%=60))/60+(e>9?":":":0")+e}const n=document.querySelector(".city"),s=document.querySelector(".weather-icon"),a=document.querySelector(".temperature"),o=document.querySelector(".weather-description");async function r(){const t=`https://api.openweathermap.org/data/2.5/weather?q=${n.value||"Minsk"}&lang=${c}&appid=c553a031b9295379b0b1312b571019d6&units=metric`,e=await fetch(t),i=await e.json();s.className=`weather-icon owf owf-${i.weather[0].id}`,a.textContent=`${i.main.temp}°C`,o.textContent=i.weather[0].description}const u="en";let l={},c=l.language||u;window.addEventListener("beforeunload",(function(){localStorage.setItem("settings",JSON.stringify(l))})),window.addEventListener("load",(function(){const t=localStorage.getItem("settings");t&&(l=JSON.parse(t)),c=l.language||u,h()}));const d=document.querySelectorAll(".language-input");function h(){c=l.language||u,L(),S(),r()}function m(){l.language=function(t){let e;return t.forEach((t=>{t.checked&&(e=t.value)})),e}(d),h()}d.forEach((t=>t.addEventListener("change",m)));const p={timeOfDay:{en:["night","morning","afternoon","evening"],ru:["ночи","утро","день","вечер"]},greeting:{en:["Good","Good","Good","Good"],ru:["Доброй","Доброе","Добрый","Добрый"]}},g=document.querySelector(".date"),y=document.querySelector(".greeting-container .greeting"),v=document.querySelector(".greeting-container .name");function f(t){!function(t){const e=(new Date).toLocaleTimeString();t.innerHTML=e}(t),L(),S(),setTimeout(f,1e3,t)}function L(){const t=(new Date).toLocaleDateString(c,{weekday:"long",month:"long",day:"numeric"});g.innerHTML=t}function S(){const t=function(){const t=(new Date).getHours();let e;switch(!0){case t<6:e=p.timeOfDay[c][0];break;case t<12:e=p.timeOfDay[c][1];break;case t<18:e=p.timeOfDay[c][2];break;default:e=p.timeOfDay[c][3]}return e}(),e=function(){const t=(new Date).getHours();let e;switch(!0){case t<6:e=p.greeting[c][0];break;case t<12:e=p.greeting[c][1];break;case t<18:e=p.greeting[c][2];break;default:e=p.greeting[c][3]}return e}();y.innerHTML=`${e} ${t}, `}let w=(b=1,E=20,b=Math.ceil(b),E=Math.floor(E),Math.floor(Math.random()*(E-b+1))+b);var b,E;function q(){w+=1,w>20&&(w=1),N()}function k(){w-=1,w<1&&(w=20),N()}function N(){const t=`https://raw.githubusercontent.com/rolling-scopes-school/stage1-tasks/assets/images/${function(){const t=(new Date).getHours();let e;switch(!0){case t<6:e="night";break;case t<12:e="morning";break;case t<18:e="afternoon";break;default:e="evening"}return e}()}/${String(w).padStart(2,"0")}.jpg`,e=new Image;e.src=t,e.onload=()=>{document.body.style.backgroundImage=`url(${t})`}}const C=[{title:"Aqua Caelestis",src:"./assets/sounds/AquaCaelestis.mp3",duration:"00:39"},{title:"Ennio Morricone",src:"./assets/sounds/EnnioMorricone.mp3",duration:"01:37"},{title:"River Flows In You",src:"./assets/sounds/RiverFlowsInYou.mp3",duration:"01:37"},{title:"Summer Wind",src:"./assets/sounds/SummerWind.mp3",duration:"01:50"}];document.querySelectorAll(".styled-range").forEach((t=>{t.addEventListener("input",(function(){const t=this.value;this.style.background=`linear-gradient(to right, #710707 ${t}%, #C4C4C4 ${t}%)`}))})),function(){const t=document.querySelector(".settings-button"),e=document.querySelector(".settings-wrapper");t.addEventListener("click",(()=>{t.classList.toggle("active"),e.classList.toggle("active")})),document.body.addEventListener("click",(function(i){i.target.closest(".settings-wrapper")||i.target.closest(".settings-button")||(t.classList.remove("active"),e.classList.remove("active"))}))}(),function(i){const n=document.querySelector(".time");window.addEventListener("load",f.bind(null,n)),window.addEventListener("beforeunload",t.bind(null,v,"name")),window.addEventListener("load",e.bind(null,v,"name"))}(),function(){N();const t=document.querySelector(".slide-next"),e=document.querySelector(".slide-prev");t.addEventListener("click",q),e.addEventListener("click",k)}(),window.addEventListener("beforeunload",t.bind(null,n,"city")),window.addEventListener("load",(()=>{e(n,"city"),r()})),n.addEventListener("change",r),function(){const t=document.querySelector(".quote"),e=document.querySelector(".author"),i=document.querySelector(".change-quote");async function n(){const i=await fetch("https://favqs.com/api/qotd"),n=await i.json();t.textContent=n.quote.body,e.textContent=n.quote.author}n(),i.addEventListener("click",n)}(),new class{constructor(t){this.player=document.querySelector(t),this.init()}init(){this.playBtn=this.player.querySelector(".play"),this.progressRange=this.player.querySelector(".player-progress-range"),this.playNextBtn=this.player.querySelector(".play-next"),this.playPrevBtn=this.player.querySelector(".play-prev"),this.playListContainer=this.player.querySelector(".play-list"),this.trackTitle=this.player.querySelector(".player-title"),this.volumeRange=this.player.querySelector(".player-volume-range"),this.volumeButton=this.player.querySelector(".player-volume"),this.currentTimeField=this.player.querySelector(".current-time"),this.durationField=this.player.querySelector(".duration"),this.playNum=0,this.trackTitle.textContent=C[this.playNum].title,this.audio=new Audio,this.audio.src=C[this.playNum].src,this.createPlayList(C),this.playListItems=this.player.querySelectorAll(".play-item"),this.playNextBtn.addEventListener("click",this.playNext.bind(this)),this.playPrevBtn.addEventListener("click",this.playPrev.bind(this)),this.playBtn.addEventListener("click",this.toggleAudio.bind(this)),this.playListItems.forEach(((t,e)=>t.addEventListener("click",this.playThis.bind(this,e)))),this.audio.volume=parseInt(this.volumeRange.value)/100,this.volumeRange.addEventListener("input",this.handleVolumeUpdate.bind(this)),this.audio.addEventListener("volumechange",this.updateMuteButton.bind(this)),this.volumeButton.addEventListener("click",this.changeMuteAuido.bind(this)),this.audio.addEventListener("play",this.updatePlayElements.bind(this)),this.audio.addEventListener("pause",this.updatePlayElements.bind(this)),this.audio.addEventListener("ended",this.playNext.bind(this)),this.audio.addEventListener("timeupdate",this.changeProgress.bind(this)),this.progressRange.addEventListener("input",this.setProgress.bind(this)),this.audio.onloadeddata=()=>{this.currentTimeField.textContent="0:00",this.durationField.textContent=i(this.audio.duration)},this.audio.addEventListener("timeupdate",this.changeTime.bind(this))}toggleAudio(){this.audio.paused?this.audio.play():this.audio.pause()}updatePlayElements(){this.audio.paused?(this.playBtn.classList.remove("pause"),this.playListItems[this.playNum].classList.remove("item-active")):(this.playBtn.classList.add("pause"),this.playListItems.forEach((t=>t.classList.remove("item-active"))),this.playListItems[this.playNum].classList.add("item-active"))}playNext(){this.playNum++,this.playNum>C.length-1&&(this.playNum=0),this.audio.src=C[this.playNum].src,this.trackTitle.textContent=C[this.playNum].title,this.audio.currentTime=0,this.toggleAudio()}playPrev(){this.playNum--,this.playNum<0&&(this.playNum=C.length-1),this.audio.src=C[this.playNum].src,this.trackTitle.textContent=C[this.playNum].title,this.audio.currentTime=0,this.toggleAudio()}playThis(t){this.playNum=t,this.audio.src=C[this.playNum].src,this.trackTitle.textContent=C[this.playNum].title,this.audio.currentTime=0,this.toggleAudio()}changeProgress(){const t=this.audio.duration||1,e=this.audio.currentTime/t*100;this.progressRange.value=e,this.progressRange.style.background=`linear-gradient(to right, #710707 ${e}%, #C4C4C4 ${e}%)`}setProgress(){this.audio.currentTime=this.progressRange.value/100*this.audio.duration}changeTime(){this.currentTimeField.textContent=i(this.audio.currentTime),this.durationField.textContent=i(this.audio.duration)}handleVolumeUpdate(){this.audio.volume=parseInt(this.volumeRange.value)/100}updateMuteButton(){console.log(this.audio.volume),0==this.audio.volume?this.replaceSvgHref(this.volumeButton,"volume-mute"):this.audio.volume<=.25?this.replaceSvgHref(this.volumeButton,"volume-down"):this.audio.volume<=.75?this.replaceSvgHref(this.volumeButton,"volume-middle"):this.replaceSvgHref(this.volumeButton,"volume-up")}changeMuteAuido(){0==this.audio.volume?(this.replaceSvgHref(this.volumeButton,"volume-mute"),this.audio.volume=parseInt(this.volumeRange.value)/100):(this.replaceSvgHref(this.volumeButton,"volume-up"),this.audio.volume=0)}createPlayList(t){t.forEach((t=>{const e=document.createElement("li");e.classList.add("play-item"),e.textContent=t.title,this.playListContainer.append(e)}))}replaceSvgHref(t,e){const i=t.querySelector("use"),n=i.href.baseVal;i.href.baseVal=n.match(/.+\.svg#/)+e}}(".player")})();